max v2;#N vpatcher 668 45 1224 872;#P origin 0 9;#P window setfont "Sans Serif" 9.;#P comment 42 157 34 196617 Start;#P hidden newex 397 339 78 196617 s mouse-pos2D;#P hidden newex 118 113 135 196617 loadmess name msd2D-rend;#N vpatcher 100 185 876 690;#P origin 28 0;#P window setfont "Sans Serif" 9.;#P window linecount 1;#P newex 312 300 81 196617 prepend moveto;#P newex 221 304 42 196617 r reset;#P newex 271 337 122 196617 jit.gl.sketch msd2D-rend;#P newex 312 274 77 196617 vexpr $f1 / 5.;#P newex 271 188 51 196617 zl slice 2;#P newex 230 154 51 196617 zl slice 1;#P newex 271 240 73 196617 prepend lineto;#P newex 271 214 77 196617 vexpr $f1 / 5.;#P newex 70 272 77 196617 vexpr $f1 / 5.;#P newex 70 220 51 196617 zl slice 1;#P newex 604 355 61 196617 s msd2D-in;#P newex 658 284 85 196617 prepend posY fix;#P newex 604 314 85 196617 prepend posX fix;#P newex 658 256 27 196617 + 4.;#P newex 604 256 27 196617 - 4.;#P newex 658 231 39 196617 / -31.;#P newex 604 231 34 196617 / 31.;#P window linecount 0;#P newex 604 201 64 196617 unpack 0. 0.;#P window linecount 1;#P newex 604 169 65 196617 route mouse;#P newex 604 136 78 196617 r mouse-pos2D;#P newex 70 81 67 196617 r msd2D-out;#P window linecount 0;#P newex 70 108 331 196617 route massesPos linksPos;#P window linecount 1;#P newex 70 310 27 196617 t b l;#P newex 87 340 83 196617 prepend position;#P window linecount 2;#P newex 70 380 398 196617 jit.gl.gridshape msd2D-rend @shape sphere @scale 0.03 0.03 0.03 @depth_enable 1 @automatic 0 @smooth_shading 1 @lighting_enable 1 @color 0. 1. 1. 1.;#P connect 4 0 3 0;#P connect 3 0 15 0;#P connect 15 1 16 0;#P connect 16 0 2 0;#P connect 1 0 0 0;#P connect 2 0 0 0;#P connect 2 1 1 0;#P connect 3 1 19 0;#P connect 19 1 20 0;#P connect 20 0 17 0;#P connect 17 0 18 0;#P connect 18 0 22 0;#P connect 24 0 22 0;#P connect 23 0 22 0;#P connect 20 1 21 0;#P connect 21 0 24 0;#P connect 5 0 6 0;#P connect 6 0 7 0;#P connect 7 0 8 0;#P connect 8 0 10 0;#P connect 10 0 12 0;#P connect 13 0 14 0;#P connect 12 0 14 0;#P connect 7 1 9 0;#P connect 9 0 11 0;#P connect 11 0 13 0;#P pop;#P newobj 18 326 43 196617 p jitter;#P user jit.fpsgui 17 203 60 196617 0;#P user jit.pwindow 182 105 252 251 0 1 0 0 1 0;#X name msd2D-rend;#P message 208 782 40 196617 msd3D;#P message 179 782 26 196617 msd;#P hidden newex 163 803 64 196617 prepend help;#P hidden newex 163 826 45 196617 pcontrol;#P comment 132 783 50 196617 see also:;#N vpatcher 50 119 1076 559;#P origin 0 11;#P window setfont "Sans Serif" 10.;#P comment 639 673 21 196618 L0;#P comment 571 497 127 196618 Rigidity with power = 2;#P comment 571 1 100 196618 The equations are :;#P comment 497 25 142 196618 if Lmin<|L[n]-L[0]|<Lmax;#P comment 496 64 29 196618 else;#P comment 496 84 129 196618 F[n] = D(L[n]-L[n-1]);#P comment 496 43 238 196618 F[n] = K(L[n] - L[0])^P + D(L[n] - L[n-1]);#P comment 28 176 273 196618 Links connect masses two by two. They got 4 physicals parameters : length \, rigidity \, damping and power.;#P comment 27 205 370 196618 Rigidity \, damping and power are defined by the creation message. The lenght is initialised to the distance between the two masses at the creation.;#P comment 495 113 331 196618 For oriented links \, the force F[n] is projected onto a vector which is given during the creation of the link using x1y1 coordinates.;#P comment 495 158 357 196618 For normal vector \, the direction is calculated using the scalar product :;#P comment 495 237 250 196618 You can build specific links using different links messages defining the characteristic step by step.;#P comment 496 195 96 196618 x1x2 + y1y2 = 0;#P comment 27 246 329 196618 Links can be created in one shot between mutiples masses \, instead of creation number \, the masses linked are defined with their Id.;#P comment 28 30 255 196618 MSD is the 2D object of the msd objects collection.;#P pop;#P newobj 16 781 101 196617 patcher More_Info;#P window setfont "Sans Serif" 12.;#P comment 12 72 70 196620 Examples:;#P comment 9 362 47 196620 Inlets:;#P window setfont "Sans Serif" 10.;#P comment 19 384 42 196618 - Left:;#P window setfont "Sans Serif" 12.;#P comment 10 522 81 196620 Arguments:;#P comment 11 558 58 196620 Outlets:;#P comment 19 725 66 196620 See Also:;#P window setfont "Sans Serif" 10.;#P comment 74 44 62 196618 Full Name:;#P window setfont "Sans Serif" 9.;#N vpatcher 260 418 673 706;#P origin 0 -8;#P window setfont "Sans Serif" 9.;#P newex 35 245 61 196617 s msd2D-in;#P newex 35 58 51 196617 loadbang;#P newex 35 84 84 196617 b 5;#P message 107 105 35 196617 reset;#P inlet 35 37 15 0;#P message 89 125 98 196617 mass fix 0 10 0 0;#P message 35 212 187 196617 Xmax 4 \, Xmin -4 \, Ymax 4 \, Ymin -4;#P message 71 145 230 196617 mass mob 1 100 0 -2 \, mass mob 1 100 2 0 \, mass mob 1 100 0 2 \, mass mob 1 100 -2 0;#P message 53 184 250 196617 link souple fix mob 10 10 \, link souple mob mob 10 10;#P connect 4 0 7 0;#P connect 7 0 6 0;#P connect 6 0 2 0;#P connect 0 0 8 0;#P connect 1 0 8 0;#P connect 2 0 8 0;#P connect 3 0 8 0;#P connect 5 0 8 0;#P connect 6 1 0 0;#P connect 6 2 1 0;#P connect 6 3 3 0;#P connect 6 4 5 0;#P pop;#P newobj 17 127 68 196617 patcher init;#P newex 18 292 73 196617 s msd2D-out;#P newex 18 243 69 196617 r msd2D-in;#N vpatcher 157 258 654 608;#P window setfont "Sans Serif" 9.;#P window linecount 0;#P newex 125 165 42 196617 s reset;#P outlet 102 93 15 0;#P flonum 185 57 35 9 0 0 0 3 0 0 0 221 221 221 222 222 222 0 0 0;#P newex 125 56 57 196617 qmetro 20;#P newex 125 110 85 196617 t reset erase b b;#P newex 150 211 123 196617 jit.gl.render msd2D-rend;#P message 200 142 164 196617 bang \, get massesPos \, get linksPos;#P inlet 125 34 15 0;#P window linecount 1;#P newex 200 173 61 196617 s msd2D-in;#P connect 5 0 7 0;#P connect 1 0 5 0;#P connect 5 0 4 0;#P connect 4 0 8 0;#P connect 4 2 3 0;#P connect 4 1 3 0;#P connect 6 0 5 1;#P connect 4 3 2 0;#P connect 2 0 0 0;#P pop;#P newobj 17 180 84 196617 patcher compute;#P toggle 17 152 20 0;#P button 17 97 24 0;#P window setfont "Sans Serif" 10.;#P window linecount 2;#P comment 101 384 215 196618 Bang - A bang at the left inlet compute the new model state based on previous instant.;#P window linecount 1;#P comment 158 474 219 196618 To set the model parameters after creation.;#P comment 158 452 190 196618 To create the model masses and links.;#P comment 158 497 146 196618 To get the model parameters;#P window setfont "Sans Serif" 9.;#N vpatcher 366 106 1347 763;#P origin 0 -19;#P window setfont "Sans Serif" 12.;#P comment 7 21 131 196620 CREATION Messages;#P window setfont "Sans Serif" 10.;#P message 32 123 35 196618 reset;#P comment 202 186 61 196618 Add a mass;#P comment 57 210 92 196618 \$1 : Id (symbol);#P comment 57 230 142 196618 \$2 : fixed or mobile (0/1);#P comment 57 248 57 196618 \$3 : mass;#P message 32 305 79 196618 deleteMass \$1;#P comment 194 307 173 196618 Delete a mass and associated links;#P comment 54 328 128 196618 \$1 : Creation No of mass;#P window setfont "Sans Serif" 12.;#P comment 7 156 62 196620 Masses :;#P comment 7 93 53 196620 Reset :;#P window setfont "Sans Serif" 10.;#P comment 129 124 236 196618 Delete all masses \, links and internal variables;#P window setfont "Sans Serif" 12.;#P comment 6 370 49 196620 Links :;#P window setfont "Sans Serif" 10.;#P comment 49 425 92 196618 \$1 : Id (symbol);#P comment 49 478 71 196618 \$4 : rigidity;#P message 30 574 77 196618 deleteLink \$1;#P comment 166 576 71 196618 Delete a link;#P comment 47 597 124 196618 \$1 : Creation No of link;#P comment 49 425 92 196618 \$1 : Id (symbol);#P comment 49 478 71 196618 \$4 : rigidity;#P comment 49 443 149 196618 \$2 : creation No/Id of mass1;#P comment 49 461 149 196618 \$3 : creation No/Id of mass2;#P comment 266 403 66 196618 Add link(s);#P comment 49 496 73 196618 \$5 : damping;#P comment 10 47 288 196618 Creation messages are used to define the structure of the model. Messages create links and masses or destroy them.;#P message 30 403 178 196618 link \$1 \$2 \$3 \$4 \$5 ($6 \$7 \$8);#P message 32 186 119 196618 mass \$1 \$2 \$3 \$4 \$5;#P comment 57 266 127 196618 \$4 \, \$5 : initial position;#P comment 46 514 189 196618 ($6) : Power of the rigidity distance;#P comment 46 533 160 196618 ($7) : minimum lenght of link;#P comment 46 550 161 196618 ($8) : maximum lenght of link;#P button 471 94 15 0;#P button 471 597 15 0;#P comment 527 199 92 196618 \$1 : Id (symbol);#P comment 527 252 71 196618 \$4 : rigidity;#P comment 527 199 92 196618 \$1 : Id (symbol);#P comment 527 252 71 196618 \$4 : rigidity;#P comment 527 217 149 196618 \$2 : creation No/Id of mass1;#P comment 527 235 149 196618 \$3 : creation No/Id of mass2;#P comment 527 270 73 196618 \$5 : damping;#P comment 790 171 117 196618 Add tangential link(s);#P comment 526 289 136 196618 \$6 \, \$7 : tangential vector;#P comment 524 308 189 196618 ($8) : Power of the rigidity distance;#P comment 524 327 160 196618 ($9) : minimum lenght of link;#P comment 524 344 168 196618 ($10) : maximum lenght of link;#P comment 528 401 92 196618 \$1 : Id (symbol);#P comment 528 454 71 196618 \$4 : rigidity;#P comment 528 401 92 196618 \$1 : Id (symbol);#P comment 528 454 71 196618 \$4 : rigidity;#P comment 528 419 149 196618 \$2 : creation No/Id of mass1;#P comment 528 437 149 196618 \$3 : creation No/Id of mass2;#P comment 528 472 73 196618 \$5 : damping;#P comment 525 510 189 196618 ($8) : Power of the rigidity distance;#P comment 525 529 160 196618 ($9) : minimum lenght of link;#P comment 525 546 168 196618 ($10) : maximum lenght of link;#P message 508 172 225 196618 tLink \$1 \$2 \$3 \$4 \$5 \$6 \$7 ($8 \$9 \$10);#P message 511 377 227 196618 nLink \$1 \$2 \$3 \$4 \$5 \$6 \$7 ($8 \$9 \$10);#P comment 527 491 123 196618 \$6 \, \$7 : normal vector;#P window setfont "Sans Serif" 12.;#P comment 504 94 100 196620 Oriented links :;#P window setfont "Sans Serif" 10.;#P comment 793 376 104 196618 Add normal link(s);#P comment 506 121 362 196618 In 2D (and 3D) there are two specials links : oriented links. They works as general links excepts their calculation is made following a vector.;#P user panel 5 92 457 20;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 5 21 457 20;#X brgb 191 191 191;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 5 370 457 20;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 5 155 457 20;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 502 93 457 20;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P connect 34 0 33 0;#P pop;#P newobj 12 453 124 196617 patcher creation;#P window setfont "Sans Serif" 10.;#P comment 103 541 33 196618 None;#P comment 19 579 42 196618 - Left:;#P comment 101 580 329 196618 Outputs the model parameters asked with the attributes messages.;#P comment 19 624 49 196618 - Right:;#P window linecount 2;#P comment 100 625 363 196618 Outputs information on model when creation messages are send or with the special message [infosL( which dump the complete state of the model.;#P comment 101 416 242 196618 Messages - Different messages are used to control the msd object. They are of three types :;#P window linecount 1;#P comment 9 747 100 196618 CATEGORY: control;#P window setfont "Sans Serif" 9.;#N vpatcher 733 166 1219 786;#P origin 0 -19;#P window setfont "Sans Serif" 12.;#P window linecount 0;#P comment 7 81 62 196620 Masses :;#P comment 6 397 49 196620 Links :;#P comment 7 21 186 196620 DYNAMIC SETTINGS Messages;#P window setfont "Sans Serif" 10.;#P message 31 115 66 196618 posX \$1 \$2;#P comment 190 163 117 196618 Add force on mass(es);#P message 31 162 75 196618 forceX \$1 \$2;#P comment 192 235 59 196618 \$1 : Value;#P comment 193 126 121 196618 \$1 : Id (symbol) or No;#P comment 193 180 121 196618 \$1 : Id (symbol) or No;#P message 31 214 52 196618 Xmin \$1;#P message 89 214 53 196618 Xmax \$1;#P message 31 263 74 196618 setMobile \$1;#P message 31 284 67 196618 setFixed \$1;#P comment 193 108 155 196618 Set position of fixed mass(es);#P comment 193 144 59 196618 \$2 : Value;#P comment 193 198 59 196618 \$2 : Value;#P comment 189 219 265 196618 Set minimimum and maximum position of all masses;#P comment 188 263 141 196618 Set mass to mobile or fixed;#P message 31 485 65 196618 setD \$1 \$2;#P comment 184 471 82 196618 \$2 : New value;#P message 31 434 65 196618 setK \$1 \$2;#P comment 184 527 82 196618 \$2 : New value;#P comment 184 580 82 196618 \$2 : New value;#P comment 178 435 118 196618 Set rigidity of link(s);#P comment 178 491 120 196618 Set damping of link(s);#P message 31 540 64 196618 setL \$1 \$2;#P comment 178 544 144 196618 Set initial lenght of link(s);#P comment 184 453 121 196618 \$1 : Id (symbol) or No;#P comment 184 509 121 196618 \$1 : Id (symbol) or No;#P comment 184 562 121 196618 \$1 : Id (symbol) or No;#P comment 191 280 121 196618 \$1 : Id (symbol) or No;#P window linecount 2;#P comment 10 44 251 196618 Dynamic settings messages allows the user to redefine internal parameters of links and masses.;#P window linecount 1;#P message 31 320 107 196618 grabMass \$1 \$2 \$3;#P comment 186 320 99 196618 Grab nearest mass;#P comment 191 336 93 196618 \$1 \, \$2 : position;#P comment 190 353 122 196618 \$3 : grab or not (0/1);#P message 31 136 66 196618 posY \$1 \$2;#P message 31 183 75 196618 forceY \$1 \$2;#P message 31 236 52 196618 Ymin \$1;#P message 89 236 53 196618 Ymax \$1;#P user panel 6 79 457 20;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 6 19 457 20;#X brgb 191 191 191;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 6 395 457 20;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 20 429 111 157;#X brgb 191 191 191;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 20 104 134 276;#X brgb 191 191 191;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P pop;#P newobj 12 474 123 196617 patcher dynamic settings;#N vpatcher 382 95 863 769;#P origin 0 -19;#P window setfont "Sans Serif" 12.;#P comment 7 93 63 196620 General :;#P comment 7 21 147 196620 ATTRIBUTES Messages;#P comment 7 156 48 196620 Lists :;#P window setfont "Sans Serif" 10.;#P message 33 123 40 196618 infosL;#P comment 136 123 239 196618 Get infos on all masses and links on right outlet;#P message 32 189 67 196618 massesPosL;#P message 32 258 82 196618 massesForcesL;#P comment 170 189 253 196618 Output all masses positions in a list on outlet No 1;#P comment 139 340 209 196618 Get specific attribute on specific element;#P message 32 338 70 196618 get \$1 ($2);#P window setfont "Sans Serif" 12.;#P comment 6 300 66 196620 Specific :;#P window setfont "Sans Serif" 10.;#P comment 139 435 299 196618 The get message return the asked attribute preceded by an identifier and the creation No of the element. The identifier is made of the asked parameter and the way you asked for it.;#P comment 140 511 49 196618 message;#P comment 380 511 53 196618 response;#P comment 139 492 309 196618 Examples with 3 masses numbered 0 \, 1 and 2 and named mas:;#P comment 145 601 254 196618 [get massesPos mas( -----> [massesPosId 0 x0(;#P comment 334 616 107 196618 [massesPosId 2 x2(;#P comment 334 631 107 196618 [massesPosId 1 x1(;#P comment 173 530 223 196618 [get massesPos( -----> [massesPos 0 x0(;#P comment 334 544 98 196618 [massesPos 2 x2(;#P comment 334 558 98 196618 [massesPos 1 x1(;#P comment 159 580 245 196618 [get massesPos 1( -----> [massesPosNo 1 x1(;#P comment 15 49 371 196618 The attributes messages ask the object to output some of his internal parameters. They can be output by lists for positions and forces of masses.;#P comment 169 259 291 196618 Output all forces applied on masses in a list on outlet No 1;#P comment 139 402 247 196618 ($2) : - If not defined all the attributes are send for all the elements. - Ids or/and creations No;#P message 32 211 73 196618 massesPosXL;#P comment 170 221 238 196618 Output all masses x or y in a list on outlet No 1;#P message 32 232 73 196618 massesPosYL;#P comment 139 365 243 196618 \$1 : Attribute type ( massesPos / massesSpeeds / massesForces / linksPos / linksLenghts);#P user panel 6 92 457 20;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 6 21 457 20;#X brgb 191 191 191;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 6 155 457 20;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 6 299 457 20;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 24 114 89 33;#X brgb 191 191 191;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 24 182 97 105;#X brgb 191 191 191;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 24 329 96 50;#X brgb 191 191 191;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P pop;#P newobj 12 495 123 196617 patcher attributes;#P window setfont "Sans Serif" 10.;#P comment 9 757 267 196618 KEYWORDS: physical model mass spring damper link;#P comment 301 782 201 196618 - Nicolas Montgermont \, May 12 \, 2005;#P window setfont "Sans Serif" 12.;#P comment 12 3 89 196620 HELP: msd2D;#P comment 12 18 361 196620 DESCRIPTION: Mass spring damper physical modeling in 2D.;#P window setfont "Sans Serif" 10.;#P newex 157 44 43 196618 msd2D;#P comment 257 726 126 196618 editor/msd2d-editor.pd;#P comment 112 726 96 196618 01_msd2Dtest.pd;#P window setfont "Sans Serif" 9.;#P newex 18 267 43 196617 msd2D;#P window setfont "Sans Serif" 10.;#P comment 202 90 211 196618 Sorry \, you need Jitter for this example...;#P user panel 16 383 55 17;#X brgb 191 191 191;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 16 577 55 17;#X brgb 191 191 191;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 16 622 55 17;#X brgb 191 191 191;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P user panel 9 361 521 19;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P background;#P user panel 9 71 521 19;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P background;#P user panel 9 1 521 38;#X brgb 214 214 214;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P background;#P user panel 9 521 521 19;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P background;#P user panel 9 556 521 19;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P background;#P user panel 9 724 521 19;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P background;#P user panel 9 745 521 31;#X brgb 214 214 214;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P background;#P user panel 9 778 521 25;#X brgb 135 163 161;#X frgb 0 0 0;#X border 0;#X rounded 0;#X shadow 0;#X done;#P background;#P connect 34 0 39 0;#P connect 35 0 36 0;#P connect 36 0 54 0;#P connect 37 0 12 0;#P connect 12 0 38 0;#P hidden connect 52 0 50 0;#P hidden connect 51 0 50 0;#P hidden connect 50 0 49 0;#P hidden connect 56 0 53 0;#P hidden connect 53 1 57 0;#P pop;